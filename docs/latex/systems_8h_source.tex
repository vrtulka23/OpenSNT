\doxysection{systems.\+h}
\hypertarget{systems_8h_source}{}\label{systems_8h_source}\index{src/puq/systems/systems.h@{src/puq/systems/systems.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ PUQ\_SYSTEMS\_H}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ PUQ\_SYSTEMS\_H}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ <string>}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ <set>}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ <map>}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <stack>}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <sstream>}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ "{}../settings.h"{}}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ "{}../magnitude.h"{}}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{keyword}{namespace\ }puq\ \{}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00016\ \textcolor{comment}{\ \ \ *\ \ Unit\ types}}
\DoxyCodeLine{00017\ \textcolor{comment}{\ \ \ */}}
\DoxyCodeLine{00018\ \ \ }
\DoxyCodeLine{00019\ \ \ \textcolor{keyword}{enum\ class}\ Utype\ :\ std::uint8\_t\ \{}
\DoxyCodeLine{00020\ \ \ \ \ NUL\ =\ 0b00000000,\ \ \textcolor{comment}{//\ empty\ flag}}
\DoxyCodeLine{00021\ \ \ \ \ BAS\ =\ 0b00000001,\ \ \textcolor{comment}{//\ base\ units}}
\DoxyCodeLine{00022\ \ \ \ \ LIN\ =\ 0b00000010,\ \ \textcolor{comment}{//\ standard\ unit\ (linear\ conversion)}}
\DoxyCodeLine{00023\ \ \ \ \ LOG\ =\ 0b00000100,\ \ \textcolor{comment}{//\ logarithmic\ unit}}
\DoxyCodeLine{00024\ \ \ \ \ TMP\ =\ 0b00001000,\ \ \textcolor{comment}{//\ temperature\ unit}}
\DoxyCodeLine{00025\ \ \ \ \ CST\ =\ 0b00010000,\ \ \textcolor{comment}{//\ constant}}
\DoxyCodeLine{00026\ \ \ \ \ CSB\ =\ 0b00100000,\ \ \textcolor{comment}{//\ base\ constant}}
\DoxyCodeLine{00027\ \ \ \ \ QUA\ =\ 0b01000000,\ \ \textcolor{comment}{//\ quantity}}
\DoxyCodeLine{00028\ \ \ \};}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \ \ \textcolor{keyword}{inline}\ Utype\ operator|(Utype\ lhs,\ Utype\ rhs)\ \{}
\DoxyCodeLine{00031\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}Utype\textcolor{keyword}{>}(}
\DoxyCodeLine{00032\ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}std::underlying\_type\_t<Utype>\textcolor{keyword}{>}(lhs)\ |}
\DoxyCodeLine{00033\ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}std::underlying\_type\_t<Utype>\textcolor{keyword}{>}(rhs)}
\DoxyCodeLine{00034\ \ \ \ \ \ \ );}
\DoxyCodeLine{00035\ \ \ \}}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \ \ \textcolor{keyword}{inline}\ Utype\ operator\&(Utype\ lhs,\ Utype\ rhs)\ \{}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}Utype\textcolor{keyword}{>}(}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}std::underlying\_type\_t<Utype>\textcolor{keyword}{>}(lhs)\ \&}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}std::underlying\_type\_t<Utype>\textcolor{keyword}{>}(rhs)}
\DoxyCodeLine{00041\ \ \ \ \ \ \ );}
\DoxyCodeLine{00042\ \ \ \}}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \ \ \textcolor{keyword}{inline}\ Utype\ operator\string^(Utype\ lhs,\ Utype\ rhs)\ \{}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}Utype\textcolor{keyword}{>}(}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}std::underlying\_type\_t<Utype>\textcolor{keyword}{>}(lhs)\ \string^}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}std::underlying\_type\_t<Utype>\textcolor{keyword}{>}(rhs)}
\DoxyCodeLine{00048\ \ \ \ \ \ \ );}
\DoxyCodeLine{00049\ \ \ \}}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \ \ \textcolor{keyword}{const}\ Utype\ UT\_LIN\_BAS\ \ \ \ \ =\ Utype::LIN|Utype::BAS;}
\DoxyCodeLine{00052\ \ \ \textcolor{keyword}{const}\ Utype\ UT\_LIN\_BAS\_CST\ =\ Utype::LIN|Utype::BAS|Utype::CST;}
\DoxyCodeLine{00053\ \ \ \textcolor{keyword}{const}\ Utype\ UT\_LIN\_BAS\_TMP\ =\ Utype::LIN|Utype::BAS|Utype::TMP;}
\DoxyCodeLine{00054\ \ \ \textcolor{keyword}{const}\ Utype\ UT\_LIN\_TMP\ \ \ \ \ =\ Utype::LIN|Utype::TMP;}
\DoxyCodeLine{00055\ \ \ \textcolor{keyword}{const}\ Utype\ UT\_LIN\_CST\ \ \ \ \ =\ Utype::LIN|Utype::CST;}
\DoxyCodeLine{00056\ \ \ \textcolor{keyword}{const}\ Utype\ UT\_LIN\_CSB\ \ \ \ \ =\ Utype::LIN|Utype::CSB;}
\DoxyCodeLine{00057\ \ \ \textcolor{keyword}{const}\ Utype\ UT\_LIN\_LOG\ \ \ \ \ =\ Utype::LIN|Utype::LOG;}
\DoxyCodeLine{00058\ \ \ \textcolor{keyword}{const}\ Utype\ UT\_LIN\_QUA\ \ \ \ \ =\ Utype::LIN|Utype::QUA;}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00060\ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00061\ \textcolor{comment}{\ \ \ *\ \ Prefix\ and\ unit\ list\ definitions}}
\DoxyCodeLine{00062\ \textcolor{comment}{\ \ \ */}}
\DoxyCodeLine{00063\ \ \ }
\DoxyCodeLine{00064\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structpuq_1_1_unit_prefix_struct}{UnitPrefixStruct}}\ \{}
\DoxyCodeLine{00065\ \ \ \ \ MAGNITUDE\_TYPE\ magnitude;}
\DoxyCodeLine{00066\ \ \ \ \ std::string\ definition;}
\DoxyCodeLine{00067\ \ \ \ \ std::string\ name;}
\DoxyCodeLine{00068\ \ \ \};}
\DoxyCodeLine{00069\ \ \ \textcolor{keyword}{extern}\ \textcolor{keyword}{const}\ std::unordered\_map<std::string,\ UnitPrefixStruct>\ UnitPrefixList;}
\DoxyCodeLine{00070\ \ \ \textcolor{keyword}{extern}\ \textcolor{keyword}{const}\ std::vector<std::string>\ UnitPrefixOrder;}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00072\ \ \ \textcolor{keyword}{typedef}\ std::array<EXPONENT\_TYPE,\ NUM\_BASEDIM>\ BaseDimensions;}
\DoxyCodeLine{00073\ \ \ \textcolor{keyword}{typedef}\ std::set<std::string>\ AllowedPrefixes;}
\DoxyCodeLine{00074\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structpuq_1_1_unit_struct}{UnitStruct}}\ \{}
\DoxyCodeLine{00075\ \ \ \ \ Utype\ utype;}
\DoxyCodeLine{00076\ \ \ \ \ std::string\ definition;}
\DoxyCodeLine{00077\ \ \ \ \ std::string\ name;}
\DoxyCodeLine{00078\ \ \ \ \ \textcolor{keywordtype}{bool}\ use\_prefixes;}
\DoxyCodeLine{00079\ \ \ \ \ AllowedPrefixes\ allowed\_prefixes;}
\DoxyCodeLine{00080\ \ \ \};}
\DoxyCodeLine{00081\ \ \ \textcolor{keyword}{typedef}\ std::unordered\_map<std::string,\ UnitStruct>\ UnitListType;\ \ }
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00084\ \textcolor{comment}{\ \ \ *\ \ Quantities}}
\DoxyCodeLine{00085\ \textcolor{comment}{\ \ \ */}}
\DoxyCodeLine{00086\ \ \ }
\DoxyCodeLine{00087\ \textcolor{preprocessor}{\ \ \#include\ "{}quantities.h"{}}}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00089\ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00090\ \textcolor{comment}{\ \ \ *\ \ Dimension\ map}}
\DoxyCodeLine{00091\ \textcolor{comment}{\ \ \ */}}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ \ \ \textcolor{keyword}{class\ }DimensionMapExcept:\ \textcolor{keyword}{public}\ std::exception\ \{}
\DoxyCodeLine{00094\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00095\ \ \ \ \ std::string\ message;}
\DoxyCodeLine{00096\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00097\ \ \ \ \ DimensionMapExcept(std::string\ m)\ :\ message(m)\ \{\}}
\DoxyCodeLine{00098\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *\ what\ ()\ \textcolor{keyword}{const}\ \textcolor{keyword}{noexcept}\ \textcolor{keyword}{override}\ \{}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ message.c\_str();}
\DoxyCodeLine{00100\ \ \ \ \ \}}
\DoxyCodeLine{00101\ \ \ \};}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00103\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structpuq_1_1_dimension_struct}{DimensionStruct}}\ \{}
\DoxyCodeLine{00104\ \ \ \ \ MAGNITUDE\_PRECISION\ magnitude;}
\DoxyCodeLine{00105\ \ \ \ \ MAGNITUDE\_PRECISION\ error;}
\DoxyCodeLine{00106\ \ \ \ \ BaseDimensions\ dimensions;}
\DoxyCodeLine{00107\ \ \ \};}
\DoxyCodeLine{00108\ \ \ \textcolor{keyword}{typedef}\ std::unordered\_map<std::string,\ DimensionStruct>\ DimensionMapType;}
\DoxyCodeLine{00109\ \ \ }
\DoxyCodeLine{00110\ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00111\ \textcolor{comment}{\ \ \ *\ \ System\ of\ units}}
\DoxyCodeLine{00112\ \textcolor{comment}{\ \ \ */}}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00114\ \textcolor{preprocessor}{\#ifdef\ EXPONENT\_FRACTIONS}}
\DoxyCodeLine{00115\ \ \ \textcolor{keyword}{typedef}\ EXPONENT\_INT\_PRECISION\ FRC[2];}
\DoxyCodeLine{00116\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00118\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structpuq_1_1_system_data_type}{SystemDataType}}\ \{}
\DoxyCodeLine{00119\ \ \ \ \ std::string\ SystemAbbrev;}
\DoxyCodeLine{00120\ \ \ \ \ std::string\ SystemName;}
\DoxyCodeLine{00121\ \ \ \ \ UnitListType\ UnitList;}
\DoxyCodeLine{00122\ \ \ \ \ QuantityListType\ QuantityList;}
\DoxyCodeLine{00123\ \ \ \ \ DimensionMapType\ DimensionMap;}
\DoxyCodeLine{00124\ \ \ \};}
\DoxyCodeLine{00125\ \ \ \textcolor{keyword}{namespace\ }SystemData\ \{}
\DoxyCodeLine{00126\ \textcolor{preprocessor}{\ \ \ \ \#include\ "{}system\_base.h"{}}}
\DoxyCodeLine{00127\ \ \ \ \ \textcolor{keyword}{extern}\ \mbox{\hyperlink{structpuq_1_1_system_data_type}{SystemDataType}}\ SI;}
\DoxyCodeLine{00128\ \textcolor{preprocessor}{\#ifdef\ UNIT\_SYSTEM\_CGS}}
\DoxyCodeLine{00129\ \ \ \ \ \textcolor{keyword}{extern}\ \mbox{\hyperlink{structpuq_1_1_system_data_type}{SystemDataType}}\ ESU;}
\DoxyCodeLine{00130\ \ \ \ \ \textcolor{keyword}{extern}\ \mbox{\hyperlink{structpuq_1_1_system_data_type}{SystemDataType}}\ EMU;}
\DoxyCodeLine{00131\ \ \ \ \ \textcolor{keyword}{extern}\ \mbox{\hyperlink{structpuq_1_1_system_data_type}{SystemDataType}}\ GU;}
\DoxyCodeLine{00132\ \textcolor{preprocessor}{\#endif\ \ }}
\DoxyCodeLine{00133\ \textcolor{preprocessor}{\#ifdef\ UNIT\_SYSTEM\_EUS}}
\DoxyCodeLine{00134\ \ \ \ \ \textcolor{keyword}{extern}\ \mbox{\hyperlink{structpuq_1_1_system_data_type}{SystemDataType}}\ IU;}
\DoxyCodeLine{00135\ \ \ \ \ \textcolor{keyword}{extern}\ \mbox{\hyperlink{structpuq_1_1_system_data_type}{SystemDataType}}\ US;}
\DoxyCodeLine{00136\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00137\ \textcolor{preprocessor}{\#ifdef\ UNIT\_SYSTEM\_NUS}}
\DoxyCodeLine{00138\ \ \ \ \ \textcolor{keyword}{extern}\ \mbox{\hyperlink{structpuq_1_1_system_data_type}{SystemDataType}}\ AU;}
\DoxyCodeLine{00139\ \ \ \ \ \textcolor{keyword}{extern}\ \mbox{\hyperlink{structpuq_1_1_system_data_type}{SystemDataType}}\ PU;}
\DoxyCodeLine{00140\ \ \ \ \ \textcolor{keyword}{extern}\ \mbox{\hyperlink{structpuq_1_1_system_data_type}{SystemDataType}}\ SRU;}
\DoxyCodeLine{00141\ \ \ \ \ \textcolor{keyword}{extern}\ \mbox{\hyperlink{structpuq_1_1_system_data_type}{SystemDataType}}\ GRU;}
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{keyword}{extern}\ \mbox{\hyperlink{structpuq_1_1_system_data_type}{SystemDataType}}\ GEO;}
\DoxyCodeLine{00143\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00144\ \ \ \}}
\DoxyCodeLine{00145\ \ \ \textcolor{keyword}{enum\ class}\ SystemType\ \{}
\DoxyCodeLine{00146\ \ \ \ \ NONE,\ SI,}
\DoxyCodeLine{00147\ \textcolor{preprocessor}{\#ifdef\ UNIT\_SYSTEM\_CGS}}
\DoxyCodeLine{00148\ \ \ \ \ ESU,\ GU,\ EMU,}
\DoxyCodeLine{00149\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00150\ \textcolor{preprocessor}{\#ifdef\ UNIT\_SYSTEM\_EUS}}
\DoxyCodeLine{00151\ \ \ \ \ IU,\ US,}
\DoxyCodeLine{00152\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00153\ \textcolor{preprocessor}{\#ifdef\ UNIT\_SYSTEM\_NUS}}
\DoxyCodeLine{00154\ \ \ \ \ AU,\ PU,\ SRU,\ GRU,\ GEO,}
\DoxyCodeLine{00155\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00156\ \ \ \};}
\DoxyCodeLine{00157\ \ \ \textcolor{keyword}{extern}\ std::unordered\_map<SystemType,\ SystemDataType*>\ SystemMap;}
\DoxyCodeLine{00158\ }
\DoxyCodeLine{00159\ \ \ \textcolor{keyword}{class\ }UnitSystemExcept:\ \textcolor{keyword}{public}\ std::exception\ \{}
\DoxyCodeLine{00160\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00161\ \ \ \ \ std::string\ message;}
\DoxyCodeLine{00162\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00163\ \ \ \ \ UnitSystemExcept(\textcolor{keyword}{const}\ std::string\ m)\ :\ message(m)\ \{\}}
\DoxyCodeLine{00164\ \ \ \ \ UnitSystemExcept(\textcolor{keyword}{const}\ SystemType\ st1,\ \textcolor{keyword}{const}\ SystemType\ st2)\ \{}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ it1\ =\ SystemMap.find(st1);}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ it2\ =\ SystemMap.find(st2);}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (it1\ ==\ SystemMap.end()\ ||\ it2\ ==\ SystemMap.end())\ \{}
\DoxyCodeLine{00168\ \ \ \ \ message\ =\ \textcolor{stringliteral}{"{}Unknown\ system\ type"{}};}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00170\ \ \ \ \ std::stringstream\ ss;}
\DoxyCodeLine{00171\ \ \ \ \ ss\ <<\ \textcolor{stringliteral}{"{}Incompatible\ unit\ systems:\ "{}};}
\DoxyCodeLine{00172\ \ \ \ \ ss\ <<\ it1-\/>second-\/>SystemAbbrev;}
\DoxyCodeLine{00173\ \ \ \ \ ss\ <<\ \textcolor{stringliteral}{"{}\ !=\ "{}};}
\DoxyCodeLine{00174\ \ \ \ \ ss\ <<\ it2-\/>second-\/>SystemAbbrev;}
\DoxyCodeLine{00175\ \ \ \ \ ss\ <<\ std::endl;}
\DoxyCodeLine{00176\ \ \ \ \ message\ =\ ss.str();}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00178\ \ \ \ \ \}}
\DoxyCodeLine{00179\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *\ what\ ()\ \textcolor{keyword}{const}\ \textcolor{keyword}{noexcept}\ \textcolor{keyword}{override}\ \{}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ message.c\_str();}
\DoxyCodeLine{00181\ \ \ \ \ \}}
\DoxyCodeLine{00182\ \ \ \};}
\DoxyCodeLine{00183\ \ \ }
\DoxyCodeLine{00184\ \ \ \textcolor{keyword}{class\ }UnitSystem\ \{}
\DoxyCodeLine{00185\ \ \ \ \ \textcolor{keywordtype}{bool}\ closed;}
\DoxyCodeLine{00186\ \ \ \ \ \textcolor{keyword}{static}\ std::stack<SystemDataType*>\ systemStack;}
\DoxyCodeLine{00187\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00188\ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{structpuq_1_1_system_data_type}{SystemDataType}}*\ Data;}
\DoxyCodeLine{00189\ \ \ \ \ \textcolor{keyword}{static}\ SystemType\ System;}
\DoxyCodeLine{00190\ \ \ \ \ UnitSystem(\textcolor{keyword}{const}\ SystemType\ st=SystemType::NONE);}
\DoxyCodeLine{00191\ \ \ \ \ \string~UnitSystem();}
\DoxyCodeLine{00192\ \ \ \ \ \textcolor{keywordtype}{void}\ change(\textcolor{keyword}{const}\ SystemType\ st);}
\DoxyCodeLine{00193\ \ \ \ \ \textcolor{keywordtype}{void}\ close();}
\DoxyCodeLine{00194\ \ \ \};}
\DoxyCodeLine{00195\ \ \ }
\DoxyCodeLine{00196\ \}}
\DoxyCodeLine{00197\ \ \ }
\DoxyCodeLine{00198\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ PUQ\_SYSTEMS\_H}}

\end{DoxyCode}
